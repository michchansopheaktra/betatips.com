{% extends "base.html" %}
{% load static %}
{% block content %}

<section class="my-5">
	<div class="container">
		<div class="row justify-content-center align-items-center">
			<div class="col-lg-10">
				<div class="shadow rounded p-5 bg-white">
					<div class="row">
						<div class="col-lg-12">
              				<!-- <h2 class="text-center py-3">Upload ZIP File</h2> -->


                            <h2 class="text-center py-3">{% if form.instance.pk %}Edit Affiliate Link{% else %}Add Affiliate Link{% endif %}</h2>

                            <form method="post" enctype="multipart/form-data">
                                {% csrf_token %}
                                {{ form.as_p }}

                                <button type="submit" class="btn btn-primary">
                                {% if form.instance.pk %}Update{% else %}Create{% endif %}
                                </button>
                                <a href="{{ request.META.HTTP_REFERER|default:'/' }}" class="btn btn-secondary">Cancel</a>
                            </form>
                            <h3 class="my-5">üóÇÔ∏è All Affiliate Links</h3>
                            <div class="row">
                                {% for link in affiliate_links %}
                                  <div class="col-md-4 col-sm-6 mb-4">
                                    <div class="card h-100">
                                      {% if link.image %}
                                        <img src="{{ link.image.url }}" class="card-img-top" alt="{{ link.title }}" style="object-fit: cover; height: 180px;">
                                      {% endif %}
                                      <div class="card-body d-flex flex-column">
                                        <h5 class="card-title">{{ link.title }}</h5>
                                        <a href="{{ link.url }}" target="_blank" class="card-text text-truncate" style="overflow-wrap: break-word;">{{ link.url|truncatewords:2 }}</a>
                                        <div class="mt-auto pt-3">
                                          <a href="{% url 'affiliate_link_edit' link.pk %}" 
                                             class="btn btn-sm btn-outline-danger px-3">
                                             <i class="bi bi-pencil-square"></i> Edit</a>
                                          <a href="{% url 'affiliate_link_delete' link.pk %}" 
                                             class="btn btn-sm btn-outline-danger px-3">
                                            <i class="bi bi-trash3 me-1"></i> Delete
                                          </a>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                {% empty %}
                                  <div class="col-12">
                                    <p>No affiliate links yet.</p>
                                  </div>
                                {% endfor %}
                              </div>
                            
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
{% endblock %}
